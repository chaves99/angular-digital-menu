<form class="" [formGroup]="formGroup" (ngSubmit)="onSubmit()">
  <div class="mt-5 row justify-content-center">
    <div class="mb-2 col-md-6">
      <label for="category" class="form-label">Adicionar categoria:</label>
      <input type="text" class="form-control" id="category" formControlName="name" required>
    </div>
  </div>
  <div class="d-flex row justify-content-center p-3">
    <button class="btn btn-primary col-md-3" type="submit">
      Adicionar
    </button>
  </div>
</form>

@if(categories) {
  <div class="table-responsive">
    <table class="table table-striped table-hover caption-top">
      <caption>Lista de categorias:</caption>
      <thead>
        <tr>
          <th scope="col">Nome</th>
          <th scope="col">Ativo</th>
          <th scope="col">Criado em</th>
          <th scope="col">Alterado em</th>
          <th scope="col">#</th>
          <th scope="col">#</th>
        </tr>
      </thead>
      <tbody>
        @for(cat of categories; track cat.id) {
          <tr>
            <td>{{ cat.name }}</td>
            <td>
              <i class="bi bi-check-circle-fill"
                [ngClass]="cat.enabled ? 'text-success' : 'text-danger'">
              </i>
            </td>
            <td>{{ cat.createdAt | date: 'd/M/yy, H:mm'}}</td>
            <td>{{ cat.updatedAt | date: 'd/M/yy, H:mm'}}</td>
            <td>
              <button
                type="button"
                class="btn btn-sm btn-outline-danger"
                (click)="openDeleteModal(cat)">
                  Excluir
              </button>
            </td>
            <td>
              <button
                type="button"
                class="btn btn-sm"
                (click)="openDisableModal(cat)"
                [ngClass]="cat.enabled ? 'btn-outline-warning' : 'btn-outline-primary'">
                @if (cat.enabled) {
                  Inativar
                } @else {
                  Ativar
                }
              </button>
            </td>
          </tr>
        }
      </tbody>
    </table>
  </div>

  <!--############ DISABLE MODAL ############ -->
  <div #disableModal [ngStyle]="{'display': disableModalDisplay}" class="modal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5">
          @if(disableCategorySelected) {
            @if(disableCategorySelected.enabled) {
              Inativar Categoria
            } @else {
              Ativar Categoria
            }
          }
          </h1>
          <button type="button" (click)="closeDisableModal()" class="btn-close"></button>
        </div>
        <div class="modal-body">
          @if(disableCategorySelected) {
            @if(disableCategorySelected.enabled) {
              Inativar categoria <b>{{disableCategorySelected.name}}</b>?
            } @else {
              Ativar categoria <b>{{disableCategorySelected.name}}</b>?
            }
          }
        </div>
        <div class="modal-footer">
          <button type="button" (click)="closeDisableModal()" class="btn btn-secondary">Fechar</button>
          <button type="button" (click)="disable()" class="btn btn-primary">Sim</button>
        </div>
      </div>
    </div>
  </div>


  <!--############ DELETE MODAL ############ -->
  <div #deleteModal [ngStyle]="{'display': deleteModalDisplay}" class="modal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5">Inativar Categoria</h1>
          <button type="button" (click)="closeDeleteModal()" class="btn-close"></button>
        </div>
        <div class="modal-body">
          @if(deleteCategorySelected) {
            Deletar categoria <b>{{deleteCategorySelected!.name}}</b>?
          }
        </div>
        <div class="modal-footer">
          <button type="button" (click)="closeDeleteModal()" class="btn btn-secondary">Fechar</button>
          <button type="button" (click)="delete()" class="btn btn-primary">Sim</button>
        </div>
      </div>
    </div>
  </div>
}
