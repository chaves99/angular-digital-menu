<form class="" [formGroup]="formGroup" (ngSubmit)="onSubmit()">
  <div class="mt-5 row justify-content-center">
    <div class="mb-2 col-md-6">
      <label for="category" class="form-label">Adicionar faixa de preço:</label>
      <input type="text" class="form-control" id="category" formControlName="name" required>
    </div>
  </div>
  <div class="d-flex row justify-content-center p-3">
    <button class="btn btn-primary col-md-3" type="submit">
      Adicionar
    </button>
  </div>
</form>

<div class="mt-3 table-responsive">
  @if(showAlert) {
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
      Apenas uma faixa de preço pode estar ativa simultaneamente!
      <button type="button" class="btn-close" (click)="closeAlert()"></button>
    </div>
  }
  <table class="table table-striped table-hover caption-top">
    <caption>Faixa de preços:</caption>
    <thead>
      <tr>
        <th scope="col">Nome</th>
        <th scope="col">Ativo</th>
        <th scope="col">Criado em</th>
        <th scope="col">Alterado em</th>
        <th scope="col">#</th>
        <th scope="col">#</th>
      </tr>
    </thead>
    <tbody>
      @for(pl of priceLayers; track pl.id) {
      <tr>
        <td>{{ pl.name }}</td>
        <td>
          <i class="bi bi-check-circle-fill" [ngClass]="pl.active ? 'text-success' : 'text-danger'">
          </i>
        </td>
        <td>{{ pl.createdAt | date: 'd/M/yy, H:mm'}}</td>
        <td>{{ pl.updatedAt | date: 'd/M/yy, H:mm'}}</td>
        <td>
          <button type="button" class="btn btn-sm btn-outline-danger" (click)="openDeleteModal(pl)">
            Excluir
          </button>
        </td>
        <td>
          <button type="button" class="btn btn-sm" (click)="openDisableModal(pl)"
            [ngClass]="pl.active ? 'btn-outline-warning' : 'btn-outline-primary'">
            @if (pl.active) {
              Inativar
            } @else {
              Ativar
            }
          </button>
        </td>
      </tr>
      }
    </tbody>
  </table>
</div>

<!--############ DISABLE MODAL ############ -->
<div #disableModal [ngStyle]="{'display': disableModalDisplay}" class="modal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5">
          @if(disablePriceLayerSelected) {
            @if(disablePriceLayerSelected.active) {
              Inativar faixa de preço
            } @else {
              Ativar faixa de preço
            }
          }
        </h1>
        <button type="button" (click)="closeDisableModal()" class="btn-close"></button>
      </div>
      <div class="modal-body">
        @if(disablePriceLayerSelected) {
          @if(disablePriceLayerSelected.active) {
            Inativar faixa de preço <b>{{disablePriceLayerSelected.name}}</b>?
          } @else {
            Ativar faixa de preço <b>{{disablePriceLayerSelected.name}}</b>?
          }
        }
      </div>
      <div class="modal-footer">
        <button type="button" (click)="closeDisableModal()" class="btn btn-secondary">Fechar</button>
        <button type="button" (click)="disable()" class="btn btn-primary">Sim</button>
      </div>
    </div>
  </div>
</div>


<!--############ DELETE MODAL ############ -->
<div #deleteModal [ngStyle]="{'display': deleteModalDisplay}" class="modal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5">Inativar Categoria</h1>
        <button type="button" (click)="closeDeleteModal()" class="btn-close"></button>
      </div>
      <div class="modal-body">
        @if(deletePriceLayerSelected) {
          Deletar faixa de preço <b>{{deletePriceLayerSelected!.name}}</b>?
        }
      </div>
      <div class="modal-footer">
        <button type="button" (click)="closeDeleteModal()" class="btn btn-secondary">Fechar</button>
        <button type="button" (click)="delete()" class="btn btn-primary">Sim</button>
      </div>
    </div>
  </div>
</div>
